{"version":3,"sources":["data.js","index.js"],"names":["data_inmates","1","name","Last Statement","2","video","React","createRef","mediaStream","App","_useState","useState","_useState2","Object","slicedToArray","distanceScore","setdistanceScore","_useState3","_useState4","lastwords","setlastwords","useEffect","run","log","_console","console","apply","arguments","_ref","asyncToGenerator","regenerator_default","a","mark","_callee","wrap","_context","prev","next","faceApi","tinyFaceDetector","load","navigator","mediaDevices","getUserMedia","facingMode","sent","current","srcObject","t0","message","stack","stop","this","onPlay","_ref2","_callee2","out","i","results","distance","image","deathrow","curr_distance","_context2","paused","ended","setTimeout","abrupt","selection","text","react_default","createElement","className","style","width","height","position","ref","autoPlay","muted","left","right","bottom","top","rootElement","document","getElementById","ReactDOM","render"],"mappings":"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","file":"static/js/main.f9bf5400.chunk.js","sourcesContent":["const data_inmates ={ \n    1:{\"name\": \"Autry, James David\",\"Last Statement\": \"This inmate declined to make a last statement.\"}, \n    2: {\"name\": \"guido\", \"Last Statement\": \"First, I would like to give praise to God for the love and grace that he has allowed for all of this to come together.\"}\n    \n};\n\nexport default data_inmates;","//import React from \"react\";\nimport React, { useState, useEffect } from 'react';\nimport ReactDOM from \"react-dom\";\nimport * as faceApi from \"face-api.js\";\nimport data_inmates from \"./data\";\nimport \"./styles.css\";\n\n// const expressionMap = {\n//   neutral: \"ðŸ˜¶\",\n//   happy: \"ðŸ˜„\",\n//   sad: \"ðŸ˜ž\",\n//   angry: \"ðŸ¤¬\",\n//   fearful: \"ðŸ˜–\",\n//   disgusted: \"ðŸ¤¢\",\n//   surprised: \"ðŸ˜²\"\n// };\nvar video = React.createRef();\nvar mediaStream = React.createRef();\n//class App extends React.Component \nfunction App (){\n//   var video = React.createRef();\n//   var mediaStream = React.createRef();\n  //state = { expressions: [] };\n\n  const [distanceScore, setdistanceScore] = useState(1.0)\n  const [lastwords, setlastwords] = useState(\"\")\n\n\n  useEffect(() => run(), []);\n\n//   componentDidMount() {\n//     this.run();\n//   }\n\n  const log = (...args) => {\n    console.log(...args);\n  };\n\n  const run = async () => {\n    log(\"run started\");\n    try {\n      await faceApi.nets.tinyFaceDetector.load(\"/models/\");\n      await faceApi.loadFaceExpressionModel(`/models/`);\n      await faceApi.loadFaceRecognitionModel(`/models/`);\n      mediaStream = await navigator.mediaDevices.getUserMedia({\n        video: { facingMode: \"user\" }\n      });\n\n    video.current.srcObject = mediaStream;\n    } catch (e) {\n      log(e.name, e.message, e.stack);\n    }\n  };\n\n  const onPlay = async () => {\n\n    \n\n    if (\n      video.current.paused ||\n      video.current.ended //||\n      //!faceApi.nets.tinyFaceDetector.params\n    ) {\n      setTimeout(() => onPlay());\n      return;\n    }\n\n    // const options = new faceApi.TinyFaceDetectorOptions({\n    //   inputSize: 512,\n    //   scoreThreshold: 0.5\n    // });\n\n    // const result = await faceApi\n    //   .detectSingleFace(video.current, options)\n    //   .withFaceExpressions();\n  \n    var out = await faceApi.computeFaceDescriptor(video.current);\n    \n\n    var i;\n    var results = {\"selection\": 1, \"text\": \"none\"};\n    var distance = 1.0;\n    for (i = 1; i < 3; i++) {\n      \n      console.log(\"/images/\" + i + \".jpeg\")\n      const image = await faceApi.fetchImage(\"/images/\" + i + \".jpeg\");\n      var deathrow = await faceApi.computeFaceDescriptor(image);\n      let curr_distance = faceApi.round(\n        faceApi.euclideanDistance(out, deathrow)\n      )\n      \n      if (curr_distance < distance){\n        results[\"selection\"] = i;\n        results[\"text\"] = data_inmates[i][\"Last Statement\"];\n        distance = curr_distance;\n        setdistanceScore(distance);\n      }\n\n    }\n\n    console.log(results);\n    setlastwords(results.text)\n\n    // if (result) {\n    //   log(result);\n    //   const expressions = result.expressions.reduce(\n    //     (acc, { expression, probability }) => {\n    //       acc.push([expressionMap[expression], probability]);\n    //       return acc;\n    //     },\n    //     []\n    //   );\n    //   log(expressions);\n    //   setExpressions(expressions)\n    //   //this.setState(() => ({ expressions }));\n    // }\n\n    setTimeout(() => onPlay(), 5000);\n  };\n\n  \n    return (\n      <div className=\"App\">\n        <h1>Last statement {distanceScore} and {lastwords}</h1>\n        \n        <div style={{ width: \"100%\", height: \"100vh\", position: \"relative\" }}>\n          <video\n            ref={video}\n            autoPlay\n            muted\n            onPlay={onPlay}\n            style={{\n              position: \"absolute\",\n              width: \"100%\",\n              height: \"100vh\",\n              left: 0,\n              right: 0,\n              bottom: 0,\n              top: 0\n            }}\n          />\n        </div>\n      </div>\n    );\n  \n}\n\nconst rootElement = document.getElementById(\"root\");\nReactDOM.render(<App />, rootElement);\n\n//https://github.com/justadudewhohacks/face-api.js/blob/master/examples/examples-browser/views/bbtFaceSimilarity.html\n"],"sourceRoot":""}